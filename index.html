<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Boxing Rumble</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        /* Custom styles for boxing theme and animations */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a202c; /* Dark background */
        }
        .health-bar-container {
            height: 1.5rem;
            border: 2px solid #fff;
            background-color: #374151;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.5), 0 2px 4px -2px rgba(0, 0, 0, 0.5);
        }
        .health-bar {
            transition: width 0.3s ease-in-out, background-color 0.3s;
        }

        /* --- Pop-Out Animation for Move Result --- */
        @keyframes pop-out-anim {
            0% { opacity: 0; transform: scale(0.5); }
            20% { opacity: 1; transform: scale(1.1); }
            100% { opacity: 0; transform: scale(1.5); }
        }

        .pop-out {
            animation: pop-out-anim 0.5s ease-out forwards;
        }

        /* Responsive button sizing for mobile */
        .game-button {
            padding: 1rem 0.5rem;
            font-weight: 700;
            border-radius: 0.75rem;
            box-shadow: 0 4px #000000;
            transition: transform 0.1s, box-shadow 0.1s;
        }
        .game-button:active {
            transform: translateY(2px);
            box-shadow: 0 2px #000000;
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <!-- Main Game Container -->
    <div id="gameContainer" class="w-full max-w-xl bg-gray-800 p-6 rounded-xl shadow-2xl border-4 border-yellow-500">

        <!-- 1. Start Screen -->
        <div id="startScreen" class="flex flex-col items-center justify-center text-center">
            <h1 class="text-5xl font-extrabold text-yellow-500 mb-6">BOXING RUMBLE</h1>
            <p class="text-gray-300 text-lg mb-8">30-Second Round: Player vs. System</p>
            <p class="text-sm text-yellow-400 mb-10 border-b border-yellow-600 pb-2">
                Mechanics: <span class="font-bold">JAB</span> beats <span class="font-bold">HOOK</span> | <span class="font-bold">HOOK</span> beats <span class="font-bold">UPPERCUT</span> | <span class="font-bold">UPPERCUT</span> beats <span class="font-bold">JAB</span>.
            </p>
            <button id="startButton" class="w-2/3 bg-green-600 hover:bg-green-700 text-white text-2xl game-button" onclick="startGame()">
                START ROUND 1
            </button>
        </div>

        <!-- 2. Game Screen -->
        <div id="gameScreen" class="hidden">
            <div class="flex justify-between items-center mb-4 text-white text-2xl font-bold">
                <span id="timerDisplay">30s</span>
                <span id="roundDisplay" class="text-yellow-400">Round 1</span>
            </div>

            <!-- Health Bars -->
            <div class="space-y-4 mb-8">
                <!-- System Health -->
                <div>
                    <div class="text-sm font-semibold text-gray-300 mb-1">System (Opponent)</div>
                    <div class="health-bar-container rounded-full">
                        <div id="systemHealth" class="health-bar bg-red-600 h-full rounded-full" style="width: 100%;"></div>
                    </div>
                </div>
                <!-- Player Health -->
                <div>
                    <div class="text-sm font-semibold text-gray-300 mb-1 text-right">Player (You)</div>
                    <div class="health-bar-container rounded-full">
                        <div id="playerHealth" class="health-bar bg-green-600 h-full rounded-full" style="width: 100%;"></div>
                    </div>
                </div>
            </div>

            <!-- Result Visual Feedback Area -->
            <div class="flex justify-center items-center h-28 sm:h-32 mb-6 relative">
                <!-- Placeholder for the actual visual effect -->
                <div id="resultVisual" class="absolute text-6xl font-black text-center" style="opacity: 0;"></div>
            </div>

            <!-- Messages and Last Move Display -->
            <div id="messageBox" class="text-center h-12 mb-6">
                <p id="gameMessage" class="text-lg font-bold text-yellow-300"></p>
                <p id="lastMove" class="text-sm text-gray-400"></p>
            </div>

            <!-- Control Buttons (Responsive Grid) -->
            <div class="grid grid-cols-3 gap-3">
                <button class="bg-blue-600 hover:bg-blue-700 text-white game-button col-span-1 text-base sm:text-lg" onclick="handleMove('jab')">JAB</button>
                <button class="bg-blue-600 hover:bg-blue-700 text-white game-button col-span-1 text-base sm:text-lg" onclick="handleMove('hook')">HOOK</button>
                <button class="bg-blue-600 hover:bg-blue-700 text-white game-button col-span-1 text-base sm:text-lg" onclick="handleMove('uppercut')">UPPERCUT</button>
            </div>

            <div class="flex justify-between mt-4">
                <button class="bg-gray-600 hover:bg-gray-700 text-white text-sm px-4 py-2 rounded-lg" onclick="togglePause()">
                    <span id="pauseButtonText">PAUSE</span>
                </button>
                <button class="bg-red-700 hover:bg-red-800 text-white text-sm px-4 py-2 rounded-lg" onclick="goToStartScreen()">
                    GO BACK
                </button>
            </div>
        </div>

        <!-- 3. Game Over Screen -->
        <div id="gameOverScreen" class="hidden text-center p-6">
            <h2 id="finalMessage" class="text-4xl font-extrabold text-yellow-500 mb-4"></h2>
            <p id="scoreSummary" class="text-lg text-gray-300 mb-6"></p>
            <button class="w-full bg-green-600 hover:bg-green-700 text-white text-xl game-button" onclick="goToStartScreen()">
                PLAY AGAIN
            </button>
        </div>

    </div>

    <script>
        // --- Game State Variables ---
        const MOVE_LOGIC = {
            'jab': 'hook',      // Jab beats Hook
            'hook': 'uppercut', // Hook beats Uppercut
            'uppercut': 'jab'   // Uppercut beats Jab
        };
        const MOVES = ['jab', 'hook', 'uppercut'];
        
        // Emojis for the visual feedback
        const PLAYER_PUNCH_EMOJI = 'ðŸ¤œ';
        const SYSTEM_PUNCH_EMOJI = 'ðŸ¤›';
        const IMPACT_EMOJI = 'ðŸ’¥';
        const SHIELD_EMOJI = 'ðŸ›¡ï¸';
        const DRAW_EMOJI = 'ðŸ¥ŠðŸ¥Š';


        let playerHealth = 100;
        let systemHealth = 100;
        const DAMAGE = 15; // Damage dealt on a successful hit

        let timer = 30; // 30 seconds per round
        let gameInterval;
        let isPaused = false;
        let isGameOver = false;

        // --- DOM Elements ---
        const startScreen = document.getElementById('startScreen');
        const gameScreen = document.getElementById('gameScreen');
        const gameOverScreen = document.getElementById('gameOverScreen');

        const playerHealthBar = document.getElementById('playerHealth');
        const systemHealthBar = document.getElementById('systemHealth');
        const timerDisplay = document.getElementById('timerDisplay');
        const gameMessage = document.getElementById('gameMessage');
        const lastMoveDisplay = document.getElementById('lastMove');
        const pauseButtonText = document.getElementById('pauseButtonText');
        const resultVisual = document.getElementById('resultVisual');
        const moveButtons = document.querySelectorAll('.grid button');


        // --- Core Game Functions ---

        /**
         * Converts health percentage to a CSS color string.
         */
        function getHealthColor(health, type) {
            if (health > 70) return type === 'player' ? 'bg-green-600' : 'bg-red-600';
            if (health > 30) return 'bg-yellow-500';
            return 'bg-red-700';
        }

        /**
         * Updates the visual health bars.
         */
        function updateHealthDisplay() {
            playerHealth = Math.max(0, playerHealth);
            systemHealth = Math.max(0, systemHealth);

            playerHealthBar.style.width = `${playerHealth}%`;
            systemHealthBar.style.width = `${systemHealth}%`;

            // Update colors based on health status
            playerHealthBar.className = `health-bar h-full rounded-full ${getHealthColor(playerHealth, 'player')}`;
            systemHealthBar.className = `health-bar h-full rounded-full ${getHealthColor(systemHealth, 'system')}`;
        }

        /**
         * Handles the main game loop timer.
         */
        function gameLoop() {
            if (isPaused || isGameOver) return;

            timer--;
            timerDisplay.textContent = `${timer}s`;

            if (timer <= 0) {
                endGame('time');
            }
        }

        /**
         * System (AI) chooses a move randomly.
         */
        function systemChooseMove() {
            const randomIndex = Math.floor(Math.random() * MOVES.length);
            return MOVES[randomIndex];
        }

        /**
         * Temporarily disables move buttons to prevent spamming during animation.
         */
        function disableControls(duration = 500) {
            moveButtons.forEach(btn => btn.disabled = true);
            setTimeout(() => {
                if (!isPaused && !isGameOver) {
                    moveButtons.forEach(btn => btn.disabled = false);
                }
            }, duration);
        }

        /**
         * Generates and plays the pop-out animation for the result.
         * @param {string} playerMove - The player's move.
         * @param {string} systemMove - The system's move.
         * @param {string} outcome - 'win', 'lose', or 'draw'.
         */
        function showResultVisual(playerMove, systemMove, outcome) {
            let visualHTML = '';
            
            // Generate the visual based on the outcome
            if (outcome === 'win') {
                // Player wins: Player's fist, their winning move, and impact.
                visualHTML = `<span class="text-green-400">${PLAYER_PUNCH_EMOJI}</span> <span class="text-4xl font-extrabold text-white">${playerMove.toUpperCase()}</span> <span class="text-yellow-400">${IMPACT_EMOJI}</span>`;
            } else if (outcome === 'lose') {
                // Player loses: System's fist (opposing/flipped), system's winning move, and block.
                visualHTML = `<span class="text-red-500">${SYSTEM_PUNCH_EMOJI}</span> <span class="text-4xl font-extrabold text-white">${systemMove.toUpperCase()}</span> <span class="text-gray-400">${SHIELD_EMOJI}</span>`;
            } else {
                // Draw: Neutral clash.
                visualHTML = `<span class="text-gray-500">${DRAW_EMOJI}</span> <span class="text-xl font-normal text-white">CLASH</span>`;
            }

            resultVisual.innerHTML = visualHTML;
            
            // Apply animation classes
            resultVisual.classList.remove('pop-out');
            resultVisual.style.opacity = '0';
            // Trigger reflow/repaint to ensure animation resets
            void resultVisual.offsetWidth; 
            resultVisual.classList.add('pop-out');

            // Clear visual after animation completes
            setTimeout(() => {
                resultVisual.style.opacity = '0';
                resultVisual.classList.remove('pop-out');
            }, 500);
        }

        /**
         * Compares moves and applies damage.
         * @param {string} playerMove - The player's move.
         * @param {string} systemMove - The system's move.
         */
        function resolveMoves(playerMove, systemMove) {
            let resultMessage = '';
            let outcome = 'draw';

            // Check if player beats system
            if (MOVE_LOGIC[playerMove] === systemMove) {
                systemHealth -= DAMAGE;
                resultMessage = 'SUCCESS! Your ' + playerMove.toUpperCase() + ' lands!';
                outcome = 'win';
            }
            // Check if system beats player
            else if (MOVE_LOGIC[systemMove] === playerMove) {
                playerHealth -= DAMAGE;
                resultMessage = 'BLOCKED! System counters with a ' + systemMove.toUpperCase() + '!';
                outcome = 'lose';
            }
            // It's a tie
            else {
                resultMessage = 'CLASH! Both moves canceled out.';
                outcome = 'draw';
            }

            // Show the pop-out visual feedback
            showResultVisual(playerMove, systemMove, outcome);
            disableControls(); // Lock controls for the duration of the animation

            // Update UI
            updateHealthDisplay();
            gameMessage.textContent = resultMessage;
            lastMoveDisplay.textContent = `You: ${playerMove.toUpperCase()} | System: ${systemMove.toUpperCase()}`;

            // Check for game end condition
            if (playerHealth <= 0 || systemHealth <= 0) {
                endGame('KO');
            }
        }

        // --- Event Handlers ---

        /**
         * Called when a player clicks a move button.
         * @param {string} move - 'jab', 'hook', or 'uppercut'.
         */
        function handleMove(move) {
            if (isPaused || isGameOver || moveButtons[0].disabled) return;

            const systemMove = systemChooseMove();
            resolveMoves(move, systemMove);
        }

        /**
         * Starts the game, initializes state, and sets up the timer.
         */
        function startGame() {
            // Reset state
            playerHealth = 100;
            systemHealth = 100;
            timer = 30;
            isPaused = false;
            isGameOver = false;

            if (gameInterval) clearInterval(gameInterval);

            // Set up new game
            updateHealthDisplay();
            timerDisplay.textContent = `${timer}s`;
            gameMessage.textContent = 'Fight!';
            lastMoveDisplay.textContent = 'Choose your move!';
            pauseButtonText.textContent = 'PAUSE';
            moveButtons.forEach(btn => btn.disabled = false); 

            // Show game screen, hide others
            startScreen.classList.add('hidden');
            gameOverScreen.classList.add('hidden');
            gameScreen.classList.remove('hidden');

            // Start the timer loop 
            gameInterval = setInterval(gameLoop, 1000);
        }

        /**
         * Toggles the pause state of the game.
         */
        function togglePause() {
            if (isGameOver) return;
            isPaused = !isPaused;
            pauseButtonText.textContent = isPaused ? 'RESUME' : 'PAUSE';
            gameMessage.textContent = isPaused ? 'Round Paused.' : 'Fight!';
            // Disable controls if paused
            moveButtons.forEach(btn => btn.disabled = isPaused);
        }

        /**
         * Ends the current game round.
         */
        function endGame(reason) {
            if (isGameOver) return; 
            isGameOver = true;
            clearInterval(gameInterval);
            moveButtons.forEach(btn => btn.disabled = true); 

            // Determine winner
            let finalMsg = '';
            if (playerHealth > systemHealth) {
                finalMsg = (reason === 'KO' ? 'KNOCKOUT! YOU WIN!' : 'TIME! YOU WIN on Health!');
            } else if (systemHealth > playerHealth) {
                finalMsg = (reason === 'KO' ? 'KNOCKOUT! SYSTEM WINS!' : 'TIME! SYSTEM WINS on Health!');
            } else {
                finalMsg = 'DRAW! Both fighters are standing.';
            }

            document.getElementById('finalMessage').textContent = finalMsg;
            document.getElementById('scoreSummary').textContent = `Final Score: You ${playerHealth} vs System ${systemHealth}`;

            // Show Game Over screen
            gameScreen.classList.add('hidden');
            gameOverScreen.classList.remove('hidden');
        }

        /**
         * Resets the game and returns to the start screen.
         */
        function goToStartScreen() {
            if (gameInterval) clearInterval(gameInterval);
            gameInterval = null;
            isGameOver = true; 

            // Show start screen, hide others
            startScreen.classList.remove('hidden');
            gameScreen.classList.add('hidden');
            gameOverScreen.classList.add('hidden');
        }

        // Initialize the game on load to show the start screen
        window.onload = goToStartScreen;

    </script>
</body>
</html>
